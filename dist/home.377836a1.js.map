{"version":3,"sources":["src/helper/record.ts","src/helper/video.ts","src/pages/home/index.tsx","node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","push","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","JSON","parse","type","handled","assets","forEach","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","console","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","document","body","appendChild","getElementById","remove","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","length","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"home.377836a1.js","sourceRoot":"..","sourcesContent":["class PageRecord {\r\n  public eventsList:[] \r\n\r\n  constructor() {\r\n    this.eventsList = [];\r\n  }\r\n\r\n  init (){\r\n    console.log('record init');\r\n    \r\n    const options = {\r\n      childList: true, // 是否观察子节点的变动\r\n      subtree: true, // 是否观察所有后代节点的变动\r\n      attributes: true, // 是否观察属性的变动\r\n      attributeOldValue: true, // 是否观察属性的变动的旧值\r\n      characterData: true, // 是否节点内容或节点文本的变动\r\n      characterDataOldValue: true, // 是否节点内容或节点文本的变动的旧值\r\n      // attributeFilter: ['class', 'src'] 在此数组中的属性变化时将被忽略\r\n    };\r\n    \r\n    const observer = new MutationObserver((mutationList) => {\r\n        console.log(mutationList);\r\n        \r\n    });\r\n    observer.observe(document.documentElement, options);\r\n  }\r\n}\r\n\r\nexport default PageRecord","//@ts-nocheck\r\nconst ACTION_TYPE_ATTRIBUTE = 1; //动作类型 修改元素属性\r\nconst ACTION_TYPE_ELEMENT = 2; //动作类型 元素增减\r\nconst ACTION_TYPE_MOUSE = 3; //动作类型 元素增减\r\n\r\n/**\r\n * dom和actions可JSON.stringify()序列化后传递到后台\r\n */\r\nfunction JSVideo() {\r\n  this.id = 1;\r\n  this.idMap = new Map(); //唯一标识和元素之间的映射\r\n  this.dom = this.serialization(document.documentElement);\r\n  console.log(\"序列化\", this.dom);\r\n  console.log(\"map\", this.idMap);\r\n  this.currentObserve = null;\r\n  this.actions = []; //动作日志\r\n  this.mouseTimer = null; //鼠标timer\r\n  this.observer();\r\n  this.observerInput();\r\n  this.observerMouse();\r\n}\r\n\r\nJSVideo.prototype = {\r\n  /**\r\n   * DOM序列化\r\n   */\r\n  serialization(parent) {\r\n    if (parent.tagName === \"SCRIPT\") {\r\n      return null;\r\n    }\r\n    let element = this.parseElement(parent);\r\n    if (parent.children.length == 0) {\r\n      parent.textContent && (element.textContent = parent.textContent);\r\n      return element;\r\n    }\r\n    Array.from(parent.children, (child) => {\r\n      element.children.push(this.serialization(child));\r\n    });\r\n    return element;\r\n  },\r\n  /**\r\n   * 将元素解析成可序列化的对象\r\n   */\r\n  parseElement(element, id) {\r\n    if (!element) {\r\n      return null;\r\n    }\r\n    let attributes = {};\r\n    for (const { name, value } of Array.from(element.attributes)) {\r\n      attributes[name] = value;\r\n    }\r\n    if (!id) {\r\n      //解析新元素才做映射\r\n      id = this.getID();\r\n      console.log(\"getID\", element, id);\r\n      this.idMap.set(element, id); //元素为键，ID为值\r\n    }\r\n    return {\r\n      children: [],\r\n      id: id,\r\n      tagName: element.tagName.toLowerCase(),\r\n      attributes: attributes,\r\n    };\r\n  },\r\n  /**\r\n   * DOM反序列化\r\n   */\r\n  deserialization(obj) {\r\n    if (!obj) {\r\n      return null;\r\n    }\r\n    let element = this.createElement(obj);\r\n    if (obj.children.length == 0) {\r\n      return element;\r\n    }\r\n    obj.children.forEach((child) => {\r\n      const el = this.deserialization(child);\r\n      if (el) {\r\n        element.appendChild(el);\r\n      }\r\n    });\r\n    return element;\r\n  },\r\n  /**\r\n   * 将对象解析成元素\r\n   */\r\n  createElement(obj) {\r\n    if (!obj) {\r\n      return null;\r\n    }\r\n    let element = document.createElement(obj.tagName);\r\n    if (obj.id) {\r\n      this.idMap.set(obj.id, element); //ID为键，元素为值\r\n    }\r\n    for (const name in obj.attributes) {\r\n      element.setAttribute(name, obj.attributes[name]);\r\n    }\r\n    obj.textContent && (element.textContent = obj.textContent);\r\n    return element;\r\n  },\r\n  /**\r\n   * 唯一标识\r\n   */\r\n  getID() {\r\n    return this.id++;\r\n  },\r\n  /**\r\n   * 序列化后的DOM\r\n   */\r\n  getDOM() {\r\n    return this.dom;\r\n  },\r\n  /**\r\n   * 监控元素变化\r\n   */\r\n  observer() {\r\n    this.currentObserve = new MutationObserver((mutations) => {\r\n      console.log(mutations);\r\n      mutations.forEach((mutation) => {\r\n        const { type, target, oldValue, attributeName, addedNodes, removedNodes } = mutation;\r\n        console.log(type);\r\n\r\n        switch (type) {\r\n          case \"attributes\":\r\n            const value = target.getAttribute(attributeName);\r\n            console.log(\"attributes\", value);\r\n            this.setAttributeAction(target);\r\n            break;\r\n          case \"childList\":\r\n            this.setAttributeAction(target, {\r\n              type: ACTION_TYPE_ELEMENT,\r\n              //新增的node 保存的是序列化的dom\r\n              addedNodes: Array.from(addedNodes, (el) =>\r\n                this.serialization(el)\r\n              ),\r\n              //删除的node 保存的是node 对应的id\r\n              removedNodes: Array.from(removedNodes, (el) =>\r\n                this.idMap.get(el)\r\n              ),\r\n            });\r\n        }\r\n      });\r\n    });\r\n    this.currentObserve.observe(document, {\r\n      childList: true, // 是否观察子节点的变动\r\n      subtree: true, // 是否观察所有后代节点的变动\r\n      attributes: true, // 是否观察属性的变动\r\n      attributeOldValue: true, // 是否观察属性的变动的旧值\r\n      characterData: true, // 是否节点内容或节点文本的变动\r\n      characterDataOldValue: true, // 是否节点内容或节点文本的变动的旧值\r\n      // attributeFilter: ['class', 'src'] 在此数组中的属性变化时将被忽略\r\n    });\r\n    //this.currentObserve.disconnect();\r\n  },\r\n  // 监听鼠标\r\n  observerMouse() {\r\n    const mouse = document.createElement('div')\r\n      mouse.className = 'app-mouse';\r\n      doc.body.appendChild(mouse)\r\n    this.mouseTimer = setInterval(() => {\r\n      console.log('add ACTION_TYPE_MOUSE',);\r\n\r\n      this.actions.push({\r\n        type: ACTION_TYPE_MOUSE,\r\n        timestamp: Date.now(),\r\n        pageX: Math.round(Math.random() * 800),\r\n        pageY: Math.round(Math.random() * 800)\r\n      })\r\n    }, 2000)\r\n  },\r\n  /**\r\n   * 监控文本框的变化\r\n   */\r\n  observerInput() {\r\n    const original = Object.getOwnPropertyDescriptor(\r\n      HTMLInputElement.prototype,\r\n      \"value\"\r\n    ),\r\n      _this = this;\r\n    //监控通过代码更新的value属性\r\n    Object.defineProperty(HTMLInputElement.prototype, \"value\", {\r\n      set(value) {\r\n        console.log(\"defineProperty\", value);\r\n        setTimeout(() => {\r\n          _this.setAttributeAction(this); //异步调用，避免阻塞页面\r\n        }, 0);\r\n        original.set.call(this, value); //执行原来的set逻辑\r\n      },\r\n    });\r\n    //捕获input事件\r\n    document.addEventListener(\r\n      \"input\",\r\n      (event) => {\r\n        const { target } = event;\r\n        let text = target.value;\r\n        console.log(\"input\", text);\r\n        this.setAttributeAction(target);\r\n      },\r\n      {\r\n        capture: true, //捕获\r\n      }\r\n    );\r\n  },\r\n  /**\r\n   * 配置修改属性的动作\r\n   */\r\n  setAttributeAction(element, otherParam = {}) {\r\n    let attributes = {\r\n      type: ACTION_TYPE_ATTRIBUTE,\r\n      ...otherParam,\r\n    };\r\n    element.value && (attributes.value = element.value);\r\n    console.log(\"setAttributeAction\", attributes);\r\n    this.setAction(element, attributes);\r\n  },\r\n  /**\r\n   * 配置修改动作\r\n   */\r\n  setAction(element, otherParam = {}) {\r\n    //由于element是对象，因此Map中的key会自动更新\r\n    const id = this.idMap.get(element);\r\n    console.log(\"idMap\", \"tagId\", id, element);\r\n    const action = Object.assign(\r\n      this.parseElement(element, id),\r\n      { timestamp: Date.now() },\r\n      otherParam\r\n    );\r\n    this.actions.push(action);\r\n    console.log(\"actions\", this.actions);\r\n    console.log(\"idMap\", this.idMap);\r\n  },\r\n  getActions() {\r\n    return this.actions;\r\n  },\r\n  /**\r\n   * 回放\r\n   */\r\n  replay() {\r\n    if (this.actions.length == 0) return;\r\n    console.log(\"new idMap\", this.idMap);\r\n    console.log(\"all actions\", this.actions);\r\n\r\n    const timeOffset = 16.7; //一帧的时间间隔大概为16.7ms\r\n    let startTime = this.actions[0].timestamp; //开始时间戳\r\n    const state = () => {\r\n      const action = this.actions[0];\r\n      console.log(\"action\", action);\r\n\r\n      let element = this.idMap.get(action.id);\r\n      if (!element && action.type !== ACTION_TYPE_MOUSE) {\r\n        //取不到的元素 且不是鼠标动作 直接停止动画\r\n        return;\r\n      }\r\n      //console.log(\"state action\", action, this.actions.length);\r\n      if (startTime >= action.timestamp) {\r\n        this.actions.shift();\r\n        switch (action.type) {\r\n          //属性\r\n          case ACTION_TYPE_ATTRIBUTE:\r\n            console.log(\"action>>>>>> attributes\", action.id, element);\r\n            for (const name in action.attributes) {\r\n              //更新属性\r\n              element.setAttribute(name, action.attributes[name]);\r\n            }\r\n            //触发defineProperty拦截，拆分成两个插件会避免该问题\r\n            action.value && (element.value = action.value);\r\n            break;\r\n\r\n          //节点修改\r\n          case ACTION_TYPE_ELEMENT:\r\n            console.log(\"action>>>>>>> element\", action.id, element);\r\n            //添加节点\r\n            action.addedNodes.forEach((ch) => {\r\n              let el = this.createElement(ch);\r\n              console.log('++添加节点', ch, el);\r\n              element.appendChild(el);\r\n            });\r\n            //删除节点\r\n            action.removedNodes.forEach((id) => {\r\n              let el = this.idMap.get(id);\r\n              console.log('--删除节点', id, el);\r\n              element.removeChild(el);\r\n            });\r\n            break;\r\n\r\n          //鼠标\r\n          case ACTION_TYPE_MOUSE:\r\n            console.log(\"action>>>>>>> mouse\", action);\r\n            break;\r\n        }\r\n      }\r\n      startTime += timeOffset; //最大程度的模拟真实的时间差\r\n      console.log(\r\n        \">>>>>剩余动作:\",\r\n        this.actions.length,\r\n        \"tagId:\",\r\n        action.id,\r\n        \"startTime:\",\r\n        startTime\r\n      );\r\n      if (this.actions.length > 0) {\r\n        //当还有动作时，继续调用requestAnimationFrame()\r\n        requestAnimationFrame(state);\r\n      }\r\n    };\r\n    state();\r\n  },\r\n  /**\r\n   * 创建iframe还原页面\r\n   */\r\n  createIframe() {\r\n    //停止监听\r\n    this.currentObserve.disconnect();\r\n    window.clearInterval(this.mouseTimer)\r\n\r\n    let iframe = document.createElement(\"iframe\");\r\n    iframe.setAttribute(\"sandbox\", \"allow-same-origin\");\r\n    iframe.setAttribute(\"scrolling\", \"no\");\r\n    iframe.setAttribute(\"style\", \"pointer-events:none; border:0;\");\r\n    iframe.width = `${window.innerWidth}px`;\r\n    iframe.height = `${document.documentElement.scrollHeight}px`;\r\n    iframe.onload = () => {\r\n      const doc = iframe.contentDocument,\r\n        root = doc.documentElement,\r\n        html = this.deserialization(this.dom); //反序列化\r\n      //根元素属性附加\r\n      for (const { name, value } of Array.from(html.attributes)) {\r\n        root.setAttribute(name, value);\r\n      }\r\n      root.removeChild(root.firstElementChild); //移除head\r\n      root.removeChild(root.firstElementChild); //移除body\r\n      Array.from(html.children).forEach((child) => {\r\n        root.appendChild(child);\r\n      });\r\n      //加个定时器只是为了查看方便\r\n      setTimeout(() => {\r\n        this.replay();\r\n      }, 2000);\r\n    };\r\n    document.body.appendChild(iframe);\r\n  },\r\n};\r\n\r\nexport default JSVideo;\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport \"./index.less\";\r\nimport PageRecord from \"/src/helper/record\";\r\nimport JSVideo from \"/src/helper/video\";\r\n\r\nconst Home = () => {\r\n  const [cardList, setCardList] = useState<number[]>([1]);\r\n  const pageRecord = new PageRecord();\r\n  let video = useRef();\r\n\r\n  useEffect(() => {\r\n    // pageRecord.init()\r\n    //@ts-ignore\r\n    // video.current = new JSVideo();\r\n  }, []);\r\n\r\n  //开始录制\r\n  const handleStartRecord = () => {\r\n    //@ts-ignore\r\n    video.current = new JSVideo();\r\n  };\r\n\r\n  //结束录制并回放\r\n  const handleReplayRecord = () => {\r\n    //@ts-ignore\r\n    video.current.createIframe();\r\n  };\r\n\r\n  //添加卡片\r\n  const handleAddCard = () => {\r\n    setCardList([...cardList, cardList.length + 1]);\r\n    (\r\n      document.querySelector(\".card-item\") as any\r\n    ).style.backgroundColor = `#${Math.random().toString(16).slice(-6)}`;\r\n  };\r\n\r\n  //重置卡片\r\n  const handleResetCard = () => {\r\n    setCardList([1]);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <header className=\"font-size-32 text-center mt-24\">web record</header>\r\n      <section className=\"box-cont mt-24\">\r\n        <div className=\"flex-center mt-24\">\r\n          <button className=\"theme-btn\" onClick={handleStartRecord}>\r\n            Start Record\r\n          </button>\r\n          <button className=\"theme-btn ml-16\" onClick={handleReplayRecord}>\r\n            Replay Record\r\n          </button>\r\n          <button className=\"theme-btn ml-16\" onClick={handleAddCard}>\r\n            Add Card\r\n          </button>\r\n          <button className=\"theme-btn ml-16\" onClick={handleResetCard}>\r\n            Reset\r\n          </button>\r\n        </div>\r\n\r\n        <ul className=\"mt-24 flex flex-wrap card-cont\">\r\n          {cardList.map((it) => (\r\n            <li className=\"flex-center card-item\" key={it}>\r\n              {it}\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      </section>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}