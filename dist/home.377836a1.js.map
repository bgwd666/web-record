{"version":3,"sources":["src/helper/record.ts","src/helper/video.ts","src/pages/home/index.tsx"],"names":[],"mappings":"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","file":"home.377836a1.js","sourceRoot":"..","sourcesContent":["class PageRecord {\r\n  public eventsList:[] \r\n\r\n  constructor() {\r\n    this.eventsList = [];\r\n  }\r\n\r\n  init (){\r\n    console.log('record init');\r\n    \r\n    const options = {\r\n      childList: true, // 是否观察子节点的变动\r\n      subtree: true, // 是否观察所有后代节点的变动\r\n      attributes: true, // 是否观察属性的变动\r\n      attributeOldValue: true, // 是否观察属性的变动的旧值\r\n      characterData: true, // 是否节点内容或节点文本的变动\r\n      characterDataOldValue: true, // 是否节点内容或节点文本的变动的旧值\r\n      // attributeFilter: ['class', 'src'] 在此数组中的属性变化时将被忽略\r\n    };\r\n    \r\n    const observer = new MutationObserver((mutationList) => {\r\n        console.log(mutationList);\r\n        \r\n    });\r\n    observer.observe(document.documentElement, options);\r\n  }\r\n}\r\n\r\nexport default PageRecord","//@ts-nocheck\r\nconst ACTION_TYPE_ATTRIBUTE = 1; //动作类型 修改元素属性\r\nconst ACTION_TYPE_Element = 2; //动作类型 元素增减\r\n\r\n/**\r\n * dom和actions可JSON.stringify()序列化后传递到后台\r\n */\r\nfunction JSVideo() {\r\n  this.id = 1;\r\n  this.idMap = new Map(); //唯一标识和元素之间的映射\r\n  this.dom = this.serialization(document.documentElement);\r\n  console.log(\"序列化\", this.dom);\r\n  console.log(\"map\", this.idMap);\r\n  this.currentObserve = null;\r\n  this.actions = []; //动作日志\r\n  this.observer();\r\n  this.observerInput();\r\n}\r\n\r\nJSVideo.prototype = {\r\n  /**\r\n   * DOM序列化\r\n   */\r\n  serialization(parent) {\r\n    if (parent.tagName === \"SCRIPT\") {\r\n      return null;\r\n    }\r\n    let element = this.parseElement(parent);\r\n    if (parent.children.length == 0) {\r\n      parent.textContent && (element.textContent = parent.textContent);\r\n      return element;\r\n    }\r\n    Array.from(parent.children, (child) => {\r\n      element.children.push(this.serialization(child));\r\n    });\r\n    return element;\r\n  },\r\n  /**\r\n   * 将元素解析成可序列化的对象\r\n   */\r\n  parseElement(element, id) {\r\n    if (!element) {\r\n      return null;\r\n    }\r\n    let attributes = {};\r\n    for (const { name, value } of Array.from(element.attributes)) {\r\n      attributes[name] = value;\r\n    }\r\n    if (!id) {\r\n      //解析新元素才做映射\r\n      id = this.getID();\r\n      console.log(\"getID\", element, id);\r\n      this.idMap.set(element, id); //元素为键，ID为值\r\n    }\r\n    return {\r\n      children: [],\r\n      id: id,\r\n      tagName: element.tagName.toLowerCase(),\r\n      attributes: attributes,\r\n    };\r\n  },\r\n  /**\r\n   * DOM反序列化\r\n   */\r\n  deserialization(obj) {\r\n    if (!obj) {\r\n      return null;\r\n    }\r\n    let element = this.createElement(obj);\r\n    if (obj.children.length == 0) {\r\n      return element;\r\n    }\r\n    obj.children.forEach((child) => {\r\n      const el = this.deserialization(child);\r\n      if (el) {\r\n        element.appendChild(el);\r\n      }\r\n    });\r\n    return element;\r\n  },\r\n  /**\r\n   * 将对象解析成元素\r\n   */\r\n  createElement(obj) {\r\n    if (!obj) {\r\n      return null;\r\n    }\r\n    let element = document.createElement(obj.tagName);\r\n    if (obj.id) {\r\n      this.idMap.set(obj.id, element); //ID为键，元素为值\r\n    }\r\n    for (const name in obj.attributes) {\r\n      element.setAttribute(name, obj.attributes[name]);\r\n    }\r\n    obj.textContent && (element.textContent = obj.textContent);\r\n    return element;\r\n  },\r\n  /**\r\n   * 唯一标识\r\n   */\r\n  getID() {\r\n    return this.id++;\r\n  },\r\n  /**\r\n   * 序列化后的DOM\r\n   */\r\n  getDOM() {\r\n    return this.dom;\r\n  },\r\n  /**\r\n   * 监控元素变化\r\n   */\r\n  observer() {\r\n    this.currentObserve = new MutationObserver((mutations) => {\r\n      console.log(mutations);\r\n      mutations.forEach((mutation) => {\r\n        const { type, target, oldValue, attributeName, addedNodes } = mutation;\r\n        console.log(type);\r\n\r\n        switch (type) {\r\n          case \"attributes\":\r\n            const value = target.getAttribute(attributeName);\r\n            console.log(\"attributes\", value);\r\n            this.setAttributeAction(target);\r\n            break;\r\n          case \"childList\":\r\n            this.setAttributeAction(target, {\r\n              type: ACTION_TYPE_Element,\r\n              addedNodes: Array.from(addedNodes, (el) => this.serialization(el)),\r\n            });\r\n        }\r\n      });\r\n    });\r\n    this.currentObserve.observe(document, {\r\n      childList: true, // 是否观察子节点的变动\r\n      subtree: true, // 是否观察所有后代节点的变动\r\n      attributes: true, // 是否观察属性的变动\r\n      attributeOldValue: true, // 是否观察属性的变动的旧值\r\n      characterData: true, // 是否节点内容或节点文本的变动\r\n      characterDataOldValue: true, // 是否节点内容或节点文本的变动的旧值\r\n      // attributeFilter: ['class', 'src'] 在此数组中的属性变化时将被忽略\r\n    });\r\n    //this.currentObserve.disconnect();\r\n  },\r\n  /**\r\n   * 监控文本框的变化\r\n   */\r\n  observerInput() {\r\n    const original = Object.getOwnPropertyDescriptor(\r\n        HTMLInputElement.prototype,\r\n        \"value\"\r\n      ),\r\n      _this = this;\r\n    //监控通过代码更新的value属性\r\n    Object.defineProperty(HTMLInputElement.prototype, \"value\", {\r\n      set(value) {\r\n        console.log(\"defineProperty\", value);\r\n        setTimeout(() => {\r\n          _this.setAttributeAction(this); //异步调用，避免阻塞页面\r\n        }, 0);\r\n        original.set.call(this, value); //执行原来的set逻辑\r\n      },\r\n    });\r\n    //捕获input事件\r\n    document.addEventListener(\r\n      \"input\",\r\n      (event) => {\r\n        const { target } = event;\r\n        let text = target.value;\r\n        console.log(\"input\", text);\r\n        this.setAttributeAction(target);\r\n      },\r\n      {\r\n        capture: true, //捕获\r\n      }\r\n    );\r\n  },\r\n  /**\r\n   * 配置修改属性的动作\r\n   */\r\n  setAttributeAction(element, otherParam = {}) {\r\n    let attributes = {\r\n      type: ACTION_TYPE_ATTRIBUTE,\r\n      ...otherParam,\r\n    };\r\n    element.value && (attributes.value = element.value);\r\n    console.log(\"setAttributeAction\", attributes);\r\n    this.setAction(element, attributes);\r\n  },\r\n  /**\r\n   * 配置修改动作\r\n   */\r\n  setAction(element, otherParam = {}) {\r\n    //由于element是对象，因此Map中的key会自动更新\r\n    const id = this.idMap.get(element);\r\n    console.log(\"idMap\", 'tagId', id, element);\r\n    const action = Object.assign(\r\n      this.parseElement(element, id),\r\n      { timestamp: Date.now() },\r\n      otherParam\r\n    );\r\n    this.actions.push(action);\r\n    console.log(\"actions\", this.actions);\r\n    console.log(\"idMap\", this.idMap);\r\n  },\r\n  getActions() {\r\n    return this.actions;\r\n  },\r\n  /**\r\n   * 回放\r\n   */\r\n  replay() {\r\n    if (this.actions.length == 0) return;\r\n    console.log(\"new idMap\", this.idMap);\r\n    console.log(\"all actions\", this.actions);\r\n\r\n    const timeOffset = 16.7; //一帧的时间间隔大概为16.7ms\r\n    let startTime = this.actions[0].timestamp; //开始时间戳\r\n    const state = () => {\r\n      const action = this.actions[0];\r\n      console.log(\"action\", action);\r\n\r\n      let element = this.idMap.get(action.id);\r\n      if (!element) {\r\n        //取不到的元素直接停止动画\r\n        return;\r\n      }\r\n      //console.log(\"state action\", action, this.actions.length);\r\n      if (startTime >= action.timestamp) {\r\n        this.actions.shift();\r\n        switch (action.type) {\r\n          //属性\r\n          case ACTION_TYPE_ATTRIBUTE:\r\n            console.log(\"replay attributes\", action.id, element);\r\n            for (const name in action.attributes) {\r\n              //更新属性\r\n              element.setAttribute(name, action.attributes[name]);\r\n            }\r\n            //触发defineProperty拦截，拆分成两个插件会避免该问题\r\n            action.value && (element.value = action.value);\r\n            break;\r\n            //节点修改\r\n          case ACTION_TYPE_Element:\r\n            console.log(\"replay element\", action.id, element);\r\n            action.addedNodes.forEach(ch => {\r\n              let el = this.createElement(ch);\r\n              console.log(ch, el);\r\n              //添加节点\r\n              element.appendChild(el);\r\n            });\r\n            break;\r\n        }\r\n      }\r\n      startTime += timeOffset; //最大程度的模拟真实的时间差\r\n      console.log('剩余动作:',this.actions.length,'tagId:', action.id, startTime);\r\n      if (this.actions.length > 0) {\r\n        //当还有动作时，继续调用requestAnimationFrame()\r\n        requestAnimationFrame(state);\r\n      }\r\n    };\r\n    state();\r\n  },\r\n  /**\r\n   * 创建iframe还原页面\r\n   */\r\n  createIframe() {\r\n    //停止监听\r\n    this.currentObserve.disconnect();\r\n\r\n    let iframe = document.createElement(\"iframe\");\r\n    iframe.setAttribute(\"sandbox\", \"allow-same-origin\");\r\n    iframe.setAttribute(\"scrolling\", \"no\");\r\n    iframe.setAttribute(\"style\", \"pointer-events:none; border:0;\");\r\n    iframe.width = `${window.innerWidth}px`;\r\n    iframe.height = `${document.documentElement.scrollHeight}px`;\r\n    iframe.onload = () => {\r\n      const doc = iframe.contentDocument,\r\n        root = doc.documentElement,\r\n        html = this.deserialization(this.dom); //反序列化\r\n      //根元素属性附加\r\n      for (const { name, value } of Array.from(html.attributes)) {\r\n        root.setAttribute(name, value);\r\n      }\r\n      root.removeChild(root.firstElementChild); //移除head\r\n      root.removeChild(root.firstElementChild); //移除body\r\n      Array.from(html.children).forEach((child) => {\r\n        root.appendChild(child);\r\n      });\r\n      //加个定时器只是为了查看方便\r\n      setTimeout(() => {\r\n        this.replay();\r\n      }, 2000);\r\n    };\r\n    document.body.appendChild(iframe);\r\n  },\r\n};\r\n\r\nexport default JSVideo;\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport \"./index.less\";\r\nimport PageRecord from \"/src/helper/record\";\r\nimport JSVideo from \"/src/helper/video\";\r\n\r\nconst Home = () => {\r\n  const [cardList, setCardList] = useState<number[]>([1]);\r\n  const pageRecord = new PageRecord();\r\n  let video = useRef();\r\n\r\n  useEffect(() => {\r\n    // pageRecord.init()\r\n    //@ts-ignore\r\n    // video.current = new JSVideo();\r\n  }, []);\r\n\r\n  //开始录制\r\n  const handleStartRecord = () => {\r\n    //@ts-ignore\r\n    video.current = new JSVideo();\r\n  };\r\n\r\n  //结束录制并回放\r\n  const handleReplayRecord = () => {\r\n    //@ts-ignore\r\n    video.current.createIframe();\r\n  };\r\n\r\n  //添加卡片\r\n  const handleAddCard = () => {\r\n    setCardList([...cardList, cardList.length + 1]);\r\n    // (\r\n    //   document.querySelector(\".card-item\") as any\r\n    // ).style.backgroundColor = `#${Math.random().toString(16).slice(-6)}`;\r\n  };\r\n\r\n  //重置卡片\r\n  const handleResetCard = () => {\r\n    setCardList([1]);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <header className=\"font-size-32 text-center mt-24\">web record</header>\r\n      <section className=\"box-cont mt-24\">\r\n        <div className=\"flex-center mt-24\">\r\n          <button className=\"theme-btn\" onClick={handleStartRecord}>\r\n            Start Record\r\n          </button>\r\n          <button className=\"theme-btn ml-16\" onClick={handleReplayRecord}>\r\n            Replay Record\r\n          </button>\r\n          <button className=\"theme-btn ml-16\" onClick={handleAddCard}>\r\n            Add Card\r\n          </button>\r\n          <button className=\"theme-btn ml-16\" onClick={handleResetCard}>\r\n            Reset\r\n          </button>\r\n        </div>\r\n\r\n        <ul className=\"mt-24 flex flex-wrap card-cont\">\r\n          {cardList.map((it) => (\r\n            <li className=\"flex-center card-item\" key={it}>\r\n              {it}\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      </section>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n"]}